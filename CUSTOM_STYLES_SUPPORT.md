# Поддержка кастомных стилей

Программа поддерживает работу с кастомными стилями, а не только со стандартными стилями Word.

## Как это работает

Программа использует многоуровневый подход для определения заголовков:

### 1. Outline Level (приоритет 1)
Самый надежный способ - проверка `outline level` стиля. Это работает для любых стилей (стандартных и кастомных), у которых задан уровень структуры документа.

**Как настроить в Word:**
- Создайте или выберите кастомный стиль
- Откройте "Изменить стиль" → "Формат" → "Абзац"
- В разделе "Уровень структуры" выберите нужный уровень (1-9)

### 2. Стандартные стили Word (приоритет 2)
Распознаются стандартные стили:
- Heading 1, Heading 2, Heading 3, и т.д.
- Title, Subtitle

### 3. Паттерны в названиях стилей (приоритет 3)
Распознаются кастомные стили с названиями, содержащими:
- "Заголовок 1", "Заголовок_1", "Заголовок1"
- "H1", "H 1", "H_1"
- "Title" (уровень 1)
- "Subtitle" (уровень 2)
- "heading 1" (в любом регистре)

### 4. Анализ форматирования (приоритет 4)
Если стиль не распознан, программа анализирует форматирование:
- **Размер шрифта**: 
  - ≥18pt → уровень 1
  - ≥16pt → уровень 2
  - ≥14pt → уровень 3
- **Жирный текст** + короткая длина (<150 символов) → вероятно заголовок
- **Длина текста**:
  - <50 символов → уровень 1
  - <100 символов → уровень 2

### 5. Нумерация в тексте (приоритет 5)
Распознаются нумерованные заголовки:
- "1. Заголовок" → уровень 1
- "1.1. Подзаголовок" → уровень 2
- "1.1.1. Пункт" → уровень 3
- И т.д.

## Рекомендации для кастомных стилей

### Лучший способ (рекомендуется)
1. Создайте кастомные стили в Word
2. Установите для них **Outline Level** (уровень структуры)
3. Назовите стили понятно (например, "Заголовок_Раздела", "Заголовок_Подраздела")

### Альтернативный способ
Если нельзя изменить outline level:
1. Используйте названия стилей с паттернами (см. выше)
2. Или используйте форматирование (большой жирный шрифт для заголовков)

## Примеры кастомных стилей

### Пример 1: С outline level
```
Стиль: "Мой_Заголовок_1"
Outline Level: 1
→ Распознается как заголовок уровня 1
```

### Пример 2: С паттерном в названии
```
Стиль: "Заголовок Раздела"
→ Распознается как заголовок уровня 1 (по паттерну "Заголовок")
```

### Пример 3: По форматированию
```
Стиль: "КастомныйСтиль"
Форматирование: жирный, 18pt, текст <50 символов
→ Распознается как заголовок уровня 1
```

### Пример 4: По нумерации
```
Стиль: "Обычный"
Текст: "1.1. Название раздела"
→ Распознается как заголовок уровня 2
```

## Ограничения

1. Если кастомный стиль не имеет outline level и не соответствует паттернам, программа попытается определить его по форматированию
2. Эвристика по форматированию может давать неточные результаты для сложных случаев
3. Рекомендуется всегда устанавливать outline level для кастомных стилей заголовков

## Тестирование

Для проверки работы с кастомными стилями:
1. Создайте документ с кастомными стилями
2. Убедитесь, что для стилей заголовков установлен outline level
3. Запустите сравнение документов
4. Проверьте, что разделы и подразделы правильно распознаются в Excel

