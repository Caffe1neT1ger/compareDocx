# Тесты и скрипты для создания тестовых документов

Эта папка содержит:
- **Скрипты для генерации тестовых DOCX документов** - для проверки функционала сравнения
- **Unit-тесты и интеграционные тесты** - для проверки корректности работы программы

## Доступные скрипты

### create_test_documents.py
Создает базовые тестовые документы:
- `test_document_1.docx` - базовый документ "Техническое задание"
- `test_document_2.docx` - версия с изменениями (грамматика, добавления)
- `test_document_3.docx` - совсем другой документ "Отчет о работе"

**Использование:**
```bash
cd tests
python create_test_documents.py
```

### create_extended_test_documents.py
Создает масштабные тестовые документы для полноценного тестирования:
- `extended_test_document_1.docx` - большой документ с 8 разделами, 7 таблицами, 6 изображениями
- `extended_test_document_2.docx` - версия с множеством изменений (9 разделов, 8 таблиц, 8 изображений)

**Использование:**
```bash
cd tests
python create_extended_test_documents.py
```

### create_additional_test_documents.py
Создает дополнительные тестовые документы с кастомными стилями:
- `additional_test_document_1.docx` - документ с кастомными стилями (не стандартные Heading)
- `additional_test_document_2.docx` - версия с изменениями и разными стилями форматирования

**Использование:**
```bash
cd tests
python create_additional_test_documents.py
```

## Особенности

Все скрипты создают документы в папке `../documents/` (относительно папки `tests/`).

Документы содержат:
- Разделы и подразделы с различными уровнями вложенности
- Таблицы с данными
- Изображения (схемы, диаграммы)
- Грамматические изменения (запятые, пунктуация)
- Изменения в содержимом (тексты, значения, структура)

## Тестирование

### Запуск тестов

Для запуска всех тестов используйте pytest:

```bash
# Из корня проекта
python -m pytest tests/ -v

# С покрытием кода
python -m pytest tests/ --cov=. --cov-report=html
```

### Структура тестов

- **test_validators.py** - тесты для модуля валидации (12 тестов)
- **test_compare.py** - тесты для модуля сравнения (9 тестов)
- **test_change_types.py** - тесты для типов и подтипов изменений (11 тестов)
- **test_exporters.py** - тесты для всех экспортеров (9 тестов)
- **test_cli.py** - тесты для CLI интерфейса (8 тестов)
- **test_docx_file.py** - тесты для модуля DocxFile (7 тестов)
- **test_integration.py** - интеграционные тесты (5 тестов)

**Всего: 61 тест, покрытие кода: 67%**

### Использование тестовых документов

После создания документов используйте их для тестирования программы сравнения:

```bash
# Из корня проекта
python cli.py documents/test_document_1.docx documents/test_document_2.docx --xlsx --no-llm
```

Подробный отчет о тестировании доступен в [TEST_REPORT.md](TEST_REPORT.md).

